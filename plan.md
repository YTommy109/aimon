# 開発計画 (TODO)

このドキュメントは、AIツール連携Webアプリケーションの開発計画と進捗状況を管理するためのものです。
チェックボックス `[x]` が付いている項目が完了したタスクです。

## フェーズ1: 環境構築と基本設定 ✅

- [x] Python仮想環境のセットアップ (`uv venv`)
- [x] `pyproject.toml` の作成と `streamlit` の追加
- [x] `direnv` の設定ファイル `.envrc` の作成
- [x] `justfile` の作成と基本コマンドの登録
- [x] `.gitignore` の作成

## フェーズ2: アプリケーションの基本構造 ✅

- [x] ソースディレクトリ (`app`) の作成
- [x] Streamlitによるメイン画面 (`app.py`, `app/main_page.py`) の作成
- [x] ロギング設定 (`app/logger.py`) の実装と `log` ディレクトリの作成

## フェーズ3: データ管理機能 ✅

- [x] データファイル (`ai_tools.json`, `projects.json`) の初期作成
- [x] JSONファイルを操作するモジュール (`app/data_manager.py`) の実装

## フェーズ4: コア機能の実装 ✅

### 4.1. プロジェクト管理

- [x] プロジェクト一覧をStreamlitで表示する機能
- [x] 新規プロジェクトを作成するUIと機能の実装

### 4.2. AIツール非同期実行

- [x] 実行ボタン押下時にプロジェクトステータスを更新する機能
- [x] (モック) 非同期でAI処理を実行するバックグラウンドプロセス (`app/worker.py`) の実装
- [x] 定期的にプロジェクトステータスを更新・表示する機能

## フェーズ5: テストと品質向上 ✅

- [x] `pytest` の設定
- [x] ユニットテストの作成 (`data_manager`, `logger`, `worker`, `page_logic`)
- [x] テストカバレッジ計測の設定 (`pytest-cov`)
- [x] ビジネスロジックの分離 (`app/page_logic.py`)
- [x] `ruff`によるフォーマットと静的解析
- [x] 型ヒントの追加

## フェーズ6: UIテスト (E2E) ✅

- [x] `pytest-playwright` を用いたE2Eテストの実装
- [x] テストモードでのアプリケーション実行と、E2Eテストの連携確立

## フェーズ7: ドキュメントと仕上げ ✅

- [x] `README.md` の作成（セットアップ方法、実行方法）
- [x] 全体のコードレビューとリファクタリング (随時実施)

## フェーズ8: Excel対応 🚧

- [x] **仕様化**: `specification.md`にExcelファイル(.xlsx)を処理対象として追記
- [x] **テストデータ作成**: `tests/fixtures`ディレクトリに複雑なExcelファイルを配置
- [x] **環境準備**: `openpyxl`の追加と依存関係の更新
- [x] **実装**: Excel読み込み処理の追加
- [x] **テストコード修正**: 固定テストデータを使用するテストケースの実装
- [x] **テスト実行と品質確認**

## フェーズ9: 仕様書差異修正とAIツール管理機能追加 ✅

### 9.1. 仕様書差異修正

- [x] **プロジェクト一覧の列幅修正**: ヘッダーと行の列数を統一（6列に修正）
- [x] **プロジェクト一覧のソート追加**: 作成日時の降順でプロジェクトを表示
- [x] **AIToolエンティティの拡張**: created_at, updated_at, disabled_at フィールドを追加
- [x] **DataManagerの拡張**: AIツール管理メソッドを追加（create_ai_tool, update_ai_tool, disable_ai_tool, enable_ai_tool）

### 9.2. AIツール管理機能実装

- [x] **マルチページ対応**: Streamlitのマルチページ機能を使用してページ分割
- [x] **AIツール管理ページ**: 新しいページとして独立したAIツール管理画面を作成
- [x] **AIツール一覧表示**: 全てのAIツールを一覧で表示（無効化されたものも含む）
- [x] **AIツール登録機能**: 新規AIツールの登録モーダルの実装
- [x] **AIツール編集機能**: 既存AIツールの編集モーダルの実装
- [x] **AIツール無効化/有効化**: 論理削除による状態変更機能の実装
- [x] **AIツール管理サービス**: app/service/ai_tool.py の実装
- [x] **AIツール管理ビュー**: app/view/ai_tool_management.py の実装
- [x] **テストケース追加**: AIツール管理機能のユニットテストとE2Eテストの実装

### 9.3. 品質向上

- [x] **テスト実行**: 新機能のテストケース実行と品質確認（カバレッジ88.07%達成）
- [x] **コード品質向上**: 型アノテーション修正、lint/mypy対応、コードリファクタリング
- [x] **ユニットテスト**: 106件のテストケースが全て通過
- [x] **E2Eテスト実装**: AIツール管理機能のE2Eテストケースを実装
- [ ] **ドキュメント更新**: READMEへの機能追加に関する説明の追加

## フェーズ10: 今後の課題と改善点 🚧

### 10.1. E2Eテスト環境の改善

- [ ] **テスト実行環境**: E2Eテスト実行時の自動的なStreamlitアプリ起動の仕組み構築
- [ ] **CI/CD対応**: GitHub ActionsなどでのE2Eテスト自動実行環境の構築

### 10.2. 機能拡張

- [ ] **AIツール設定管理**: AIツールごとの詳細設定（API設定、パラメータ設定）の管理機能
- [ ] **プロジェクト-AIツール連携**: プロジェクト実行時に使用するAIツールの選択機能
- [ ] **実行履歴管理**: AIツール実行履歴の保存と表示機能

### 10.3. UX改善

- [ ] **リアルタイム更新**: WebSocketを使用したリアルタイム状態更新
- [ ] **エラーハンドリング強化**: より詳細なエラーメッセージとユーザーフィードバック
- [ ] **レスポンシブデザイン**: モバイル対応の改善

### 10.4. ドキュメント整備

- [ ] **ドキュメント更新**: READMEへの機能追加に関する説明の追加
- [ ] **API仕様書**: 内部APIの仕様書作成
- [ ] **運用ガイド**: 本番環境での運用ガイドの作成
